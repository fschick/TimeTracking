<!-- Filter -->
<ts-filter filterId="filterReportIssues"
           [filters]="filters"
           (filterChanged)="filterChanged.next($event)">
</ts-filter>

<hr>

<!-- Chart -->
<h4 class="d-inline-block" i18n="@@Page.Report.Projects.Title">
  [i18n] By  project
</h4>
<div id="chart" *ngIf="chartSeries">
  <apx-chart
    [series]="chartSeries"
    [chart]="chartOptions.chart"
    [dataLabels]="chartOptions.dataLabels"
    [plotOptions]="chartOptions.plotOptions"
    [xaxis]="chartOptions.xAxis"
    [yaxis]="chartOptions.yAxis"
    [colors]="chartOptions.colors"
    [stroke]="chartOptions.stroke"
    [tooltip]="chartOptions.tooltip"
    [states]="chartOptions.states"
    [legend]="chartOptions.legend"
  ></apx-chart>
</div>

<ts-simple-table
  [columns]="tableColumns"
  [rows]="tableRows"
  [configuration]="tableConfiguration"
  (rowsChanged)="tableRowsChanged($event.rows)">
</ts-simple-table>

<ng-template #infoCellTemplate let-row="row">
  <a class="text-secondary ms-2" (click)="openInfoDetail(infoDetailDialog)">
    <ts-icon icon="bi bi-box-arrow-up-right" class="action-icon"></ts-icon>
  </a>

  <ng-template #infoDetailDialog let-modal>
    <div class="modal-header">
      <h5 class="modal-title" ngbAutofocus>
        {{row.issue}}
      </h5>
      <button type="button" class="btn-close" (click)="modal.close()" i18n-aria-label="@@Common.Close" aria-label="[i18n] Close"></button>
    </div>
    <div class="modal-body">
      <div class="row g-3">
        <!-- Days -->
        <div class="col">
          <table>
            <tr>
              <th scope="row" colspan="2" i18n="@@Page.Report.Common.Days">[i18n] Days</th>
            </tr>
            <tr>
              <td class="pe-2" i18n="@@Page.Report.Common.Worked">[i18n] Worked</td>
              <td class="text-nowrap text-end">{{formatService.formatDays(row.daysWorked)}} {{localizedDays}}</td>
            </tr>
          </table>
        </div>

        <!-- Hours/Time -->
        <div class="col">
          <table>
            <tr>
              <th scope="row" colspan="3" i18n="@@Page.Report.Common.Hours">[i18n] Hours</th>
            </tr>
            <tr>
              <td class="pe-2" i18n="@@Page.Report.Common.Worked">[i18n] Worked</td>
              <td class="text-nowrap text-end">{{row.timeWorked | tsDuration}} {{localizedHours}}</td>
            </tr>
          </table>
        </div>

        <!-- Budget -->
        <div class="col">
          <table>
            <tr>
              <th scope="row" colspan="2" i18n="@@Page.Report.Common.Budget">[i18n] Budget</th>
            </tr>
            <tr>
              <td class="pe-2" i18n="@@Page.Report.Common.Used">[i18n] Used</td>
              <td class="text-nowrap text-end">{{formatService.formatBudget(row.budgetWorked)}} {{row.currency}}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </ng-template>

</ng-template>
